"use strict";const e=e=>"string"==typeof e,t=e=>"function"==typeof e,n=e=>e instanceof HTMLElement,s=(e,t)=>void 0===e?!t.toString().includes(".preventDefault()"):e;let c=!1;try{const e=Object.defineProperty({},"passive",{get(){c=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(e){}const o=new WeakMap,r=(c,r,l,{once:a,element:i=document.documentElement,passive:u}={})=>{if(!(e(c)&&e(r)&&t(l)&&n(i)))return console.warn("couldn't detach listener."),!1;const d=s(u,l),v=o.get(i);if(!v)return!1;const f=v[c];if(!f)return!1;const p=f[d];if(!p)return!1;const m=p.findIndex((e=>e.selector===r&&e.callback===l&&e.once===a));return-1!==m&&(1===p.length?(i.removeEventListener(c,p.handler,{passive:d}),delete f[d],!0):(p.splice(m,1),!0))},l=(e,t,n)=>{const s=((e,t,n)=>s=>{o.get(e)[t][n].forEach((({selector:o,callback:l,once:a})=>{const i=o?s.target.closest(o):s.target;i&&(!n||c&&!s.defaultPrevented||(s.preventDefault=()=>{}),l(i,s),a&&r(t,o,l,{once:a,element:e,passive:n}))}))})(e,t,n);o.get(e)[t][n].handler=s,e.addEventListener(t,s,{passive:n})};exports.emit=(t,s=document.documentElement,c)=>!(!n(s)||!e(t))&&(s.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:c})),!0),exports.off=r,exports.on=(c,r,a,{once:i,element:u=document.documentElement,passive:d}={})=>{if(!(e(c)&&e(r)&&t(a)&&n(u)))return console.warn("couldn't attach listener."),!1;const v=s(d,a),f={selector:r,callback:a,...i&&{once:i}},p=o.get(u);if(!p)return o.set(u,{[c]:{[v]:[f]}}),l(u,c,v),!0;const m=p[c];if(!m)return p[c]={[v]:[f]},l(u,c,v),!0;const E=m[v];return E?(E.push(f),!0):(m[v]=[f],l(u,c,v),!0)};
