"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=e=>"string"==typeof e,t=e=>"function"==typeof e,n=e=>e instanceof HTMLElement,s=(e,t)=>void 0===e?!t.toString().includes(".preventDefault()"):e;let o=!1;try{const e=Object.defineProperty({},"passive",{get(){o=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(e){}const c=new WeakMap,r=(o,r,l,{once:a,element:i=document.documentElement,passive:u}={})=>{if(!(e(o)&&e(r)&&t(l)&&n(i)))return console.warn("couldn't detach listener."),!1;const d=s(u,l),v=c.get(i);if(!v)return!1;const f=v[o];if(!f)return!1;const p=f[d];if(!p)return!1;const m=p.findIndex(e=>e.selector===r&&e.callback===l&&e.once===a);return-1!==m&&(1===p.length?(i.removeEventListener(o,p.handler,{passive:d}),delete f[d],!0):(p.splice(m,1),!0))},l=(e,t,n)=>{const s=((e,t,n)=>s=>{c.get(e)[t][n].forEach(({selector:c,callback:l,once:a})=>{const i=c?s.target.closest(c):s.target;i&&(!n||o&&!s.defaultPrevented||(s.preventDefault=()=>{}),l(i,s),a&&r(t,c,l,{once:a,element:e,passive:n}))})})(e,t,n);c.get(e)[t][n].handler=s,e.addEventListener(t,s,{passive:n})};exports.emit=(t,s=document.documentElement,o)=>!(!n(s)||!e(t))&&(s.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:o})),!0),exports.off=r,exports.on=(o,r,a,{once:i,element:u=document.documentElement,passive:d}={})=>{if(!(e(o)&&e(r)&&t(a)&&n(u)))return console.warn("couldn't attach listener."),!1;const v=s(d,a),f={selector:r,callback:a,...i&&{once:i}},p=c.get(u);if(!p)return c.set(u,{[o]:{[v]:[f]}}),l(u,o,v),!0;const m=p[o];if(!m)return p[o]={[v]:[f]},l(u,o,v),!0;const E=m[v];return E?(E.push(f),!0):(m[v]=[f],l(u,o,v),!0)};
