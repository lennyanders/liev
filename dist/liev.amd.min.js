define(["exports"],(function(e){"use strict";const t=e=>"string"==typeof e,n=e=>"function"==typeof e,s=e=>e instanceof HTMLElement,c=(e,t)=>void 0===e?!t.toString().includes(".preventDefault()"):e;let o=!1;try{const e=Object.defineProperty({},"passive",{get(){o=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(e){}const r=new WeakMap,l=(e,o,l,{once:i,element:a=document.documentElement,passive:u}={})=>{if(!(t(e)&&t(o)&&n(l)&&s(a)))return console.warn("couldn't detach listener."),!1;const d=c(u,l),f=r.get(a);if(!f)return!1;const v=f[e];if(!v)return!1;const m=v[d];if(!m)return!1;const p=m.findIndex(e=>e.selector===o&&e.callback===l&&e.once===i);return-1!==p&&(1===m.length?(a.removeEventListener(e,m.handler,{passive:d}),delete v[d],!0):(m.splice(p,1),!0))},i=(e,t,n)=>{const s=((e,t,n)=>s=>{r.get(e)[t][n].forEach(({selector:c,callback:r,once:i})=>{const a=c?s.target.closest(c):s.target;a&&(!n||o&&!s.defaultPrevented||(s.preventDefault=()=>{}),r(a,s),i&&l(t,c,r,{once:i,element:e,passive:n}))})})(e,t,n);r.get(e)[t][n].handler=s,e.addEventListener(t,s,{passive:n})};e.emit=(e,n=document.documentElement,c)=>!(!s(n)||!t(e))&&(n.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:c})),!0),e.off=l,e.on=(e,o,l,{once:a,element:u=document.documentElement,passive:d}={})=>{if(!(t(e)&&t(o)&&n(l)&&s(u)))return console.warn("couldn't attach listener."),!1;const f=c(d,l),v={selector:o,callback:l,...a&&{once:a}},m=r.get(u);if(!m)return r.set(u,{[e]:{[f]:[v]}}),i(u,e,f),!0;const p=m[e];if(!p)return m[e]={[f]:[v]},i(u,e,f),!0;const E=p[f];return E?(E.push(v),!0):(p[f]=[v],i(u,e,f),!0)},Object.defineProperty(e,"__esModule",{value:!0})}));
