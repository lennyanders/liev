const e=e=>"string"==typeof e,t=e=>"function"==typeof e,n=e=>e instanceof HTMLElement,c=new WeakMap,o=(o,l,r,{once:s,element:a=document.documentElement}={})=>{if(!(e(o)&&e(l)&&t(r)&&n(a)))return console.warn("couldn't detach listener."),!1;const u=c.get(a);if(!u)return!1;const d=u[o];if(!d)return!1;const i=d.findIndex(e=>e.selector===l&&e.callback===r&&e.once===s);return-1!==i&&(1===d.length?(a.removeEventListener(o,d.handler),delete u[o],!0):(d.splice(i,1),!0))},l=(e,t)=>{const n=((e,t)=>n=>{c.get(e)[t].forEach(({selector:c,callback:l,once:r})=>{const s=c?n.target.closest(c):n.target;s&&(l(s,n),r&&o(t,c,l,{once:r,element:e}))})})(e,t);c.get(e)[t].handler=n,e.addEventListener(t,n)},r=(o,r,s,{once:a,element:u=document.documentElement}={})=>{if(!(e(o)&&e(r)&&t(s)&&n(u)))return console.warn("couldn't attach listener."),!1;const d={selector:r,callback:s,...a&&{once:a}},i=c.get(u);if(!i)return c.set(u,{[o]:[d]}),l(u,o),!0;const m=i[o];return m?(m.push(d),!0):(i[o]=[d],l(u,o),!0)},s=(t,c=document.documentElement,o)=>!(!n(c)||!e(t))&&(c.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:o})),!0);export{s as emit,o as off,r as on};
